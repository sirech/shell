# -*- mode: Shell-script-*-
#
# Configuration for tmux
#
# Author: Mario Fernandez

# Use vi bindings for copy mode
set-window-option -g mode-keys vi

# Use C-x instead of C-b
set-option -g prefix C-x
unbind-key C-b

# Allow a second level of tmux (for ssh)
bind-key -n C-s send-prefix

# 0 is too far from ` ;)
set -g base-index 1
set -g pane-base-index 1

# OS X trickery to get notifications
set-option -g default-command "which reattach-to-user-namespace > /dev/null && reattach-to-user-namespace -l $SHELL || $SHELL"

# Breaks window list
# set-option -g default-terminal "screen-256color"
set-option -g bell-action any

# tmux messages are displayed for 2 seconds
set -g display-time 2000

# Window title
set-option -g set-titles on
set-option -g set-titles-string '#I: #T (#W)'
# set-option -g set-titles-string '#H:#S.#I.#P #W #T' # window number,program name,active (or not)

set-option -g visual-bell on

# Notify when a window has activity
setw -g monitor-activity on
set -g visual-activity on

set-option -g pane-active-border-fg green
set-option -g pane-active-border-bg black
set-option -g pane-border-fg white
set-option -g pane-border-bg black

set-option -g message-fg black
set-option -g message-bg green

setw -g mode-bg black

## STATUS BAR

set-option -g status-bg black
set-option -g status-fg green

# Left Panel
set-option -g status-left-length 40
set -g status-left '#[fg=green,bold]#H#  - #S# #[default]]['

# Right panel
set -g status-right '#[fg=green]][ #[fg=cyan]%Y-%m-%d #[fg=white]%H:%M#[default]'

# Active windows
set-option -g status-justify centre
setw -g window-status-bg default
setw -g window-status-format '#I #W #F'
setw -g window-status-current-fg white
setw -g window-status-current-format '#[fg=red](#[default]#I #W#[fg=red])#[default]'

# setw -g automatic-rename

## BINDINGS

bind b last-window

bind-key m command-prompt -p "swap window with:" "swap-window -t ':%%'"
bind-key M command-prompt -p "move window to:" "move-window -t ':%%'"

# Split windows
bind s split-window
bind S split-window -h

# Kill windows
bind x kill-pane
bind k kill-window

# Vi-like copy
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection-and-cancel

#
# Powerline theme
#

# Enable Powerline symbols (unless already specified otherwise in environment)
if-shell ': ${TMUX_POWERLINE_SYMBOLS?}' '' 'set-environment -g TMUX_POWERLINE_SYMBOLS "powerline"'

## TPM

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'jooize/tmux-powerline-theme'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
if "test ! -d ~/.tmux/plugins/tpm" \
       "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm'"

run '~/.tmux/plugins/tpm/tpm'
